# 自然言語処理

事柄を表す最小単位：文

補足語
修飾語

形態的特徴に基づく分類
- 膠着語
- 屈折語
- 孤立語

### 音声
最小単位は単音
言語に依存しない

### 音素
語の意味を弁別する最小単位
日本語:23,24
英語:母音16~26, 子音24

### 文字
- 音素文字
アルファベット
- 音節文字
ひらがな、カタカナ　音節を表す
結合音節文字...ハングル
- 素性文字


## 言語に共通する性質

### 言語記号の恣意性
記号
    文字、単語、文も記号。
    「形」(シニフィアン)と「意味」(シニフィエ)をもつ。
    (ソシュール)

記号の恣意性
    - 意味と形の間に関連性がない(自由) 。犬→犬、dog
    - 記号が表す概念の範囲の広さも恣意的。(言語ごとに異なる)
    → 言語が異なれば語彙・文法が異なる

無限の事柄を有限の記号で表したい

**言語の二重文節**
- 文は単なる音の羅列ではない。
    - 音素の組み合わせ


## 形態素とは

形態素(morpheme)
    意味を持つ最小の言語単位

異形態(allomorph)
    同一の形態素だが形態が異なる
雨降り、小雨、雨具

### 形態素の分類
play ed

- 内容的形態素
play(語幹stem)
- 機能的形態素
ed(接辞suffix,prefix)

- 自由形態素
play(単独で現れうる)
- 拘束形態素
ed(単独では現れない)

#### 形態素の組み合わせ

- 屈折
played, plays, playing
- 派生
player
- 複合(合成)
play ground(どちらも自由形態素)

### 階層構造

1. 音素
1. 形態素
1. 語...一つの意味のまとまり
1. 文節(日本語の場合) 
1. 文...形式上完結した言語単位。
1. 談話、テキスト...一つ以上の文からなる

## 形態素解析
形態素解析は字句解析に相当する。

形態素解析器によって結果が異なる。
→ 文法学者によって解釈が異なるというのもある。

### 応用分野
- かな漢字変換
- 機械翻訳
- 情報検索
- 自然言語インターフェース
- 音声合成
- 点字翻訳

### 難しさ
- 日本語の場合
    単語の区切りの特定が困難
    単語・形態素の定義が明確に定まっていない(複合語も多い)
    正書法がない(表記ゆれ、取り締まり,取締り...)
    同音異義語が多い(記者,汽車,貴社)
- 英語の場合
    多品詞語が多く、品詞の決定が難しい
    time→{時間、計る、雑誌名}

### 日本語の形態素解析
vitabiアルゴリズム

#### 用意
- 単語辞書
語の品詞、よみ、活用形
- 連接可能性辞書
語の連なり、文頭、文末

#### 探索法
最初の一文字から順に単語辞書との一致を探していく。
その際、連接制約も見る

→　いくかの可能性が出たとき（形態素解析のラティス構造）

- 最長一致法
長い形態素を優先（深さ優先探索）
- 2文節最長一致法
2文節が長いものを選択

- 形態素数最小法
形態素数が最小のものを選択
- 文節最小法
文節数が最小になるものを選択

- **コスト最小法**
コスト最小解を求める形態素解析アルゴリズム
(Viterbiアルゴリズム)

単語コスト（単語の現れにくさ）
連接コスト（単語と単語のつながりにくさを表す）
を文頭から見ていき、コストを加算していく。
文末から辿って最小コストの道筋を選択。

### 未知語処理
辞書に登録されていない語の扱い
→ラティス構造が作れない。

- 基本的な処理
疑似的なノードを作成。大きなコストを与える。カタカナの連続などで一単語にしてしまう
- 正規化（辞書に載ってるものにする）
すっごーい→すごい
- 辞書の自動拡充
wikipediaなどから

#### n-gram言語モデル(統計的言語モデル)
連続するn語の共通頻度に着目

- bigram確率
単語 $w_{i-1}$ 出現した後に $w_i$ が出現する確率

$$
P(w_i|w_{i-1}) = \frac{C(w_{i-1},w_i)}{C(w_{i-1})}
$$


直前の(n-1)の単語から次の単語を予測するモデル。
単語列の出現各理宇、尤もらしさを求める。

$$
P(w_1,w_2,...,w_n) = \prod-n_{i=1} P(w_i|w_{i-1})
$$

流暢な文、自然な文の選択に利用


### 英語文の形態素解析

#### Stemming(語幹処理)
屈折(派生)した単語から単語の見出しの形を求める必要がある。
fishing, fished, fish, fisher → fish + ...

- Brute-force algorithms
参照表を用いて検索
- Suffix-stripping algorithms
ed,ing,ly などで終わったら除去してみる

#### 品詞タグ付け(POS tagging)
入力単語列にもっともらしい品詞列を与える

確率的モデル。
ベイズの定理を使って、
$$
P(C_1,C_2,...,C_n|w_1,w_2,...,w_n) 
= \frac{P(C_1,C_2,...) \times P(w_1,w_2,...|C_1,C_2,...)}{P(w_1,w_2,....)}
$$

これが最大になるようにする。
文字は固定なので、分子だけ考えればよい。

- 第１項
分子を直接計算するようなデータの入手は困難
→ ある品詞が現れる確率は直前のいくつかの品詞だけに依存すると仮定（近似）する。

$$
P(C_1,C_2,...)  = \prod^n_{i=1} P(C_i|C_{i-1})
$$

- 第2項
各品詞に対してある単語が出力される確率は前後の品詞とは独立であると仮定する。

$$
 P(w_1,w_2,...|C_1,C_2,...) = \prod^n_{i=1} P(w_i|C_i)
$$

よって目的関数は

$$
\prod-n_{i=1} P(C_i|C_{i-1}) P(w_i|C_i)
$$

#### 単語/品詞の隠れマルコフモデル(HMM)
品詞→状態としてみる

最小コスト法との対応
    品詞の遷移確率：連接コスト
    単語出力確率：単語コスト

### 系列ラベリング
データ系列に対してラベル付けを行う処理
- 品詞タグ付け
- 固有表現抽出

IOB(inside-outside-beginning)タグ付け
日付、人名、地名など

CRFなどの機械学習手法による。


## 形態素解析のための単語辞書
素早い探索を行うためのデータ構造

### トライ木(Trie Tree; Prefix Tree)
文字列の長さ文探索すれば必ずたどり着く。

探索の計算量O(n)
二分探索の場合 O(log_2 n)

日本語ではそのまま使えない

### パトリシア(基数木)
文字単位ではなく、文字コードのビット単位でノードを構成
二分木になる。(0 or 1)









