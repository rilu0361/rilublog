# テンソル計算基礎


## 前提

3種類くらい構文が存在。  
加算を例に説明する。

前提として、以下のテンソルがあるものとする。
```py
>>> x = torch.randn(2, 3)
>>> x
tensor([[ 0.2099,  0.4248, -0.5536],
        [ 1.6901,  0.1024, -0.8903]])

>>> y = torch.randn(2, 3)
>>> y
tensor([[ 0.8191, -1.3280, -0.5363],
        [-0.1872, -1.6615,  0.2517]])
```

## 方法

#### 構文1：算術演算子 + 
```py
>>> x + y
tensor([[ 1.0290, -0.9032, -1.0899],
        [ 1.5029, -1.5591, -0.6386]])
```

#### 構文2：torch.add(x,y)
```py
>>> torch.add(x,y)
tensor([[ 1.0290, -0.9032, -1.0899],
        [ 1.5029, -1.5591, -0.6386]])
```

##### 構文3：出力テンソルを提示

```py
>>> result = torch.empty(2, 3)
>>> torch.add(x, y, out=result)
tensor([[ 1.0290, -0.9032, -1.0899],
        [ 1.5029, -1.5591, -0.6386]])
>>> result
tensor([[ 1.0290, -0.9032, -1.0899],
        [ 1.5029, -1.5591, -0.6386]])
```

`result` を事前に定義しておいて、計算結果をそこに流す。

#### 構文4：インプレイス
`y` に `x` を加算する。**`y`が直接変更される** 

`add_()`のように`_` がついたものは直接書き代わる動作をするらしい。

```py
>>> y.add_(x)
tensor([[ 1.0290, -0.9032, -1.0899],
        [ 1.5029, -1.5591, -0.6386]])

>>> y
tensor([[ 1.0290, -0.9032, -1.0899],
        [ 1.5029, -1.5591, -0.6386]])
```

- - -
おわりー
(2019/10/23)